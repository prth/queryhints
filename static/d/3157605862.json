{"data":{"queries":{"edges":[{"node":{"frontmatter":{"title":"Get directors of top 10 rated movies","slug":"/queries/01-get-directors-of-top-10-rated-movies","sql":"select distinct director \nfrom movies\norder by rating desc\nlimit 10;\n"}}},{"node":{"frontmatter":{"title":"Get career report of directors with their movie count, average ratings, minimum rating, maximum rating","slug":"/queries/02-Get-career-report-of-directors-with-movie-count-average-minimum-and-maximum-rating","sql":"select\n  director,\n  count(*),\n  avg(rating),\n  min(rating),\n  max(rating)\nfrom movies\ngroup by director;\n"}}},{"node":{"frontmatter":{"title":"Get hourly count of movie reviews","slug":"/queries/03-get-hourly-count-of-movie-reviews","sql":"SELECT\n  DATE_FORMAT(created_at, '%Y-%m-%d %H:00:00') as hour,\n  count(*)\nFROM reviews\nGROUP BY hour\nORDER BY hour;\n"}}},{"node":{"frontmatter":{"title":"Get count of movies without any reviews in last 7 days","slug":"/queries/04-get-count-of-movies-without-any-reviews-in-last-7-days","sql":"SELECT *\nFROM\n  movies\nLEFT JOIN reviews\nON\n  movies.id = reviews.movie_id\n  AND reviews.created_at >= DATE(NOW()) - INTERVAL 7 DAY\nWHERE reviews.movie_id IS NULL;\n"}}},{"node":{"frontmatter":{"title":"Get top 5 rated movies in each genre","slug":"/queries/04-get-top-5-rated-movies-in-each-genre","sql":"SELECT genre, movie_name, rating\nFROM\n(\n  SELECT\n    genre,\n    movie_name,\n    rating,\n    RANK() OVER (\n      PARTITION BY genre ORDER BY rating DESC\n    ) as movie_rank\n  FROM movies\n) x\nWHERE movie_rank <= 5\nORDER BY genre, rating DESC;\n"}}}]}}}