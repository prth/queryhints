---
slug: /queries/02-Get-career-report-of-directors-with-movie-count-average-minimum-and-maximum-rating
order:
  list: 2
template: query
title: Get career report of directors with their movie count, average ratings, minimum rating, maximum rating
mongodb: |
  db.movies.aggregate([
    {
      $group: {
        _id: "$director",
        count: { $sum: 1 },
        avg: { $avg: "$rating" },
        min: { $min: "$rating" },
        max: { $max: "$rating" },
      },
    },
  ])
sql: |
  select
    director,
    count(*),
    avg(rating),
    min(rating),
    max(rating)
  from movies
  group by director;
---

#### SQL

- MySQL, PostgreSQL

```sql
select
  director,
  count(*),
  avg(rating),
  min(rating),
  max(rating)
from movies
group by director;
```

#### MongoDB

```javascript
db.movies.aggregate([
  {
    $group: {
      _id: "$director",
      count: { $sum: 1 },
      avg: { $avg: "$rating" },
      min: { $min: "$rating" },
      max: { $max: "$rating" },
    },
  },
])
```
