---
slug: /queries/04-get-top-5-rated-movies-in-each-genre
order:
  list: 5
template: query
title: Get top 5 rated movies in each genre
sql: |
  SELECT genre, movie_name, rating
  FROM
  (
    SELECT
      genre,
      movie_name,
      rating,
      RANK() OVER (
        PARTITION BY genre ORDER BY rating DESC
      ) as movie_rank
    FROM movies
  ) x
  WHERE movie_rank <= 5
  ORDER BY genre, rating DESC;
---

#### SQL

- MySQL, PostgreSQL

```sql
SELECT genre, movie_name, rating
FROM
(
  SELECT
    genre,
    movie_name,
    rating,
    RANK() OVER (
      PARTITION BY genre ORDER BY rating DESC
    ) as movie_rank
  FROM movies
) x
WHERE movie_rank <= 5
ORDER BY genre, rating DESC;
```
